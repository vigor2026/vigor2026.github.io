<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="A method for jointly solving humanoid stand-up and fall recovery tasks.">
  <meta name="keywords" content="VIGOR, Humanoid">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>VIGOR</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>


</head>

<body>

  <nav class="navbar is-white is-fixed-top vigor-navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a class="navbar-item vigor-brand" href="#top">
        <strong>VIGOR: Visual Goal-In-Context Inference for Unified Humanoid Fall Safety</strong>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="vigorNavbarMenu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="vigorNavbarMenu" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#abstract">Abstract</a>
        <!-- <a class="navbar-item" href="#teaser">Teaser</a> -->
        <a class="navbar-item" href="#vision">Vision</a>
        <a class="navbar-item" href="#viser">3D</a>
        <a class="navbar-item" href="#method">Method</a>
        <a class="navbar-item" href="#factorized">Data</a>
        <a class="navbar-item" href="#fall">Fall</a>
        <a class="navbar-item" href="#stand">Stand-Up</a>
        <a class="navbar-item" href="#exp">Sim</a>
        <!-- <a class="navbar-item" href="#limits">Limitations</a> -->
        <a class="navbar-item" href="#bibtex">BibTeX</a>
      </div>
    </div>
  </nav>

  <div id="top"></div>

  <section class="hero vigor-hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">

            <h1 class="title is-1 publication-title vigor-title">
              <span class="vigor-word">
                <span class="vigor-letter vigor-V">V</span><span class="vigor-letter vigor-I">I</span><span
                  class="vigor-letter vigor-G">G</span><span class="vigor-letter vigor-O">O</span><span
                  class="vigor-letter vigor-R">R</span>
              </span>:
              <span class="vigor-letter vigor-V">V</span><span class="vigor-letter vigor-I">i</span>sual
              <span class="vigor-letter vigor-G">G</span><span class="vigor-letter vigor-O">o</span>al-In-Context
              Infe<span class="vigor-letter vigor-R">r</span>ence
              for Unified Humanoid Fall Safety
            </h1>
            <!-- <p class="vigor-subtitle">
              Unified fall mitigation + stand-up recovery with egocentric vision.
            </p> -->

            <div class="is-size-5 publication-authors vigor-authors">
              <span class="author-block"><a href="https://osheraz.github.io/">Osher Azulay</a></span>
              <span class="author-block"><a href="https://jerryxu0907.github.io/">Zhengjie Xu</a></span>
              <span class="author-block"><a href="https://schefferac2020.github.io/">Andrew Scheffer</a></span>
              <span class="author-block"><a href="https://web.eecs.umich.edu/~stellayu/">Stella X. Yu</a></span>
            </div>

            <!-- UMich image only (no text) -->
            <div class="is-size-5 publication-authors">
              <span class="author-block vigor-affil">
                <img src="./static/images/umich.png" alt="University of Michigan" style="height: 36px; width: auto;">
              </span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links vigor-links">
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2602.16511" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"><i class="fas fa-file-pdf"></i></span>
                    <span>Paper</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="https://arxiv.org/abs/2602.16511" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"><i class="ai ai-arxiv"></i></span>
                    <span>arXiv</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="https://osheraz.github.io/" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"><i class="fab fa-youtube"></i></span>
                    <span>Video</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="https://github.com/osheraz/vigor" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"><i class="fab fa-github"></i></span>
                    <span>Code</span>
                  </a>
                </span>
              </div>
            </div>

            <p class="vigor-tldr">
              <strong>TL;DR:</strong> A teacher-student framework that distills terrain-aware recovery goals into a
              deployable egocentric-depth policy.
            </p>

            <div class="vigor-top-video">
              <video id="heroVid" autoplay muted loop playsinline controls preload="metadata">
                <source src="./static/videos/comparison/fall_diagonal_stairs_FLIP_overlay.mp4" type="video/mp4">
              </video>

              <div class="vigor-vid-overlay" id="heroOverlay">
                <div id="heroPolicy" class="hero-policy">Policy disabled</div>
                <div id="heroExtra" class="hero-extra"></div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- ABSTRACT -->
  <section class="section fall-recovery" id="abstract">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Why Fall Safety?</h2>
          <div class="content has-text-justified vigor-prose">
            <p>
              Reliable fall-recovery is essential for enabling humanoid robots to operate in real, cluttered
              environments. Unlike
              quadrupeds and wheeled systems, humanoids experience high-energy impacts, complex whole-body contact, and
              significant
              viewpoint changes during a fall, and failure to stand up leaves the robot effectively inoperable.
              Existing approaches either treat
              impact mitigation and standing as separate modules or assume
              flat terrain and blind proprioceptive sensing, limiting robustness
              and safety in unstructured settings.
              We introduce a unified framework for fall mitigation and stand-up recovery with perceptual awareness using
              egocentric vision. Our method employs
              a privileged teacher that learns recovery strategies conditioned
              on sparse demonstration priors and local terrain geometry, and
              a deployable student that infers the teacher’s goal representation
              from egocentric depth and short-term proprioception via distillation. This enables the student to reason
              about both how to fall
              and how to get up while avoiding unsafe contacts. Simulation experiments demonstrate higher success and
              safer recovery across
              diverse non-flat terrains and disturbance conditions compared to blind baselines.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TEASER -->
  <!-- <section class="section" id="teaser">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">

          <div class="vigor-callout">
            <i class="fas fa-tools"></i>
            <div class="has-text-centered">
              <div class="titleline">Website is Under Construction</div>
            </div>
          </div>

          <div class="vigor-teaser-video">
            <video autoplay muted loop playsinline controls>
              <source src="./static/videos/teaser.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
  </section> -->

  <!-- VISION -->
  <section class="section" id="vision">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2">Vision-Enabled Fall Recovery</h2>

          <div class="content has-text-justified vigor-prose">
            <p>
              We investigate the impact of vision on fall recovery by comparing our visual policy to a blind
              proprioceptive-only policy.
              The controller is activated <strong>only after the robot tilts 20 degrees</strong>, ensuring recovery
              begins from a true fall.
              The blind policy exhibits <strong>more unsafe behaviors</strong>, including increased head and neck
              contacts and erratic motions.
            </p>
          </div>

          <div class="columns is-mobile">
            <div class="column is-half">
              <p class="title is-5 has-text-centered"><span class="has-text-danger">Unsafe</span> Blind policy</p>
            </div>
            <div class="column is-half">
              <p class="title is-5 has-text-centered"><span class="has-text-success">Safe</span> Visual policy (ours)
              </p>
            </div>
          </div>

          <div class="columns is-multiline vision-compare">
            <div class="column is-half">
              <div class="content">
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/comparison/blind_sideways_ext.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-half">
              <div class="content">
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/comparison/visual_sideways_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-half">
              <div class="content">
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/comparison/blind_stair_FLIP_ext.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-half">
              <div class="content">
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/comparison/fall_diagonal_stairs_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>


  <!-- SIM -->
  <section class="section" id="sim">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2 has-text-centered">Unified fall mitigation + stand-up recovery with egocentric vision.
          </h2>

          <div class="vigor-sim-carousel">
            <button class="vigor-sim-btn left" type="button" aria-label="Previous">‹</button>

            <div class="vigor-sim-track" id="simTrack">
              <!-- PAGE 1 (2 rows x 3 cols = 6) -->


              <!-- PAGE 1 -->
              <div class="vigor-sim-page">
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">stairs crawl 0</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/sim_stairs_crawl0_overlay.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">stairs fall 0</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/sim_stairs_fall0_overlay.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">stairs on back</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/sim_stairs_on_back0_overlay.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">wave 3</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/sim_wave3_overlay.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">slope crawl stand</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/slope_crawl_stand_overlay.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">stand steps good</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/stand_steps_goood_overlay.mp4" type="video/mp4">
                  </video>
                </div>
              </div>

              <div class="vigor-sim-page">
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">fall on steps</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/fall_on_steps_overlay.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">gym back stand</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/gym_back_stand.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">gym fall stairs</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/gym_fall_staris.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">gym rough</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/gym_rough.mp4" type="video/mp4">
                  </video>
                </div>
                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">gym stairs</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/gym_Stairs.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item">
                  <!-- <p class="title is-5 vigor-card-title">fall slope 3</p> -->
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/sim_fall3_slope_overlay.mp4" type="video/mp4">
                  </video>
                </div>
              </div>
              <!-- PAGE 3 -->
              <!-- PAGE 3 -->
              <div class="vigor-sim-page">
                <div class="vigor-sim-item">
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/step_start_overlay.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item">
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/steps_back_stand_overlay.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item vigor-sim-more">
                  <div class="vigor-sim-more-inner">
                    <div class="vigor-sim-more-title">todo</div>
                    <!-- <div class="vigor-sim-more-sub">We’re adding additional terrains + real-world runs.</div> -->
                  </div>
                </div>

                <div class="vigor-sim-item">
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/steps_sidestand_good_overlay.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item">
                  <video class="vigor-video" autoplay controls muted loop playsinline>
                    <source src="./static/videos/sim/wave_crawl_stand_overlay.mp4" type="video/mp4">
                  </video>
                </div>

                <div class="vigor-sim-item vigor-sim-empty"></div>
              </div>

              <button class="vigor-sim-btn right" type="button" aria-label="Next">›</button>
            </div>

          </div>
        </div>
      </div>
  </section>

  <!-- VISER -->
  <section class="section" id="viser">
    <div class="container is-max-desktop">
      <h2 class="title is-2 has-text-centered">Interactive 3D Rollouts</h2>

      <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:16px;">

        <!-- TEACHER -->
        <div class="viser-card" style="border:1px solid #ddd; border-radius:12px; overflow:hidden;">
          <div style="padding:10px; font-weight:700;">Teacher</div>

          <div class="tabs is-small is-toggle is-toggle-rounded" style="padding:0 10px 10px 10px; margin:0;">
            <ul id="teacherTabs"></ul>
          </div>

          <div style="position:relative; aspect-ratio:16/9;">
            <iframe id="teacherFrame" src="/viser-client/?playbackPath=/recordings/teacher_run/test/scene.viser"
              style="position:absolute; inset:0; width:100%; height:100%; border:0;">
            </iframe>
          </div>
        </div>



        <!-- DEPTH -->
        <div class="viser-card" style="border:1px solid #ddd; border-radius:12px; overflow:hidden;">
          <div style="padding:10px; font-weight:700;">Student (Depth)</div>

          <div class="tabs is-small is-toggle is-toggle-rounded" style="padding:0 10px 10px 10px; margin:0;">
            <ul id="depthTabs"></ul>
          </div>

          <div style="position:relative; aspect-ratio:16/9;">
            <iframe id="depthFrame"
              src="/viser-client/?playbackPath=/recordings/depth_run/2front1_depth_steps/scene.viser"
              style="position:absolute; inset:0; width:100%; height:100%; border:0;">
            </iframe>


            <div style="
            position:absolute;
            top:8px;
            right:8px;
            width:22%;
            max-width:140px;
            aspect-ratio:1/1;
            border-radius:10px;
            overflow:hidden;
            box-shadow:0 8px 24px rgba(0,0,0,0.35);
            border:1px solid rgba(255,255,255,0.4);
          ">
              <video id="depthVid" src="/recordings/depth_run/2front1_depth_steps/depth_pre.mp4" autoplay muted
                playsinline preload="auto" style="width:100%; height:100%; object-fit:cover;">
              </video>
            </div>
          </div>
        </div>

        <!-- BLIND -->
        <div class="viser-card" style="border:1px solid #ddd; border-radius:12px; overflow:hidden;">
          <div style="padding:10px; font-weight:700;">Student (Blind)</div>

          <div class="tabs is-small is-toggle is-toggle-rounded" style="padding:0 10px 10px 10px; margin:0;">
            <ul id="blindTabs"></ul>
          </div>

          <div style="position:relative; aspect-ratio:16/9;">
            <iframe id="blindFrame" src="/viser-client/?playbackPath=/recordings/blind_run/test/scene.viser"
              style="position:absolute; inset:0; width:100%; height:100%; border:0;">
            </iframe>
          </div>
        </div>

      </div>
    </div>
  </section>


  <!-- METHOD -->
  <section class="section" id="method">
    <div class="container is-max-desktop">

      <!-- Text stays narrow -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2">VIGOR Framework</h2>

          <p class="content has-text-left method-intro">
            Our visual fall-recovery policy training pipeline has four key components:
          </p>

          <ul class="content has-text-left method-list vigor-prose">
            <li><strong>1. Motion retargeting:</strong> Human fall–recovery demonstrations are kinematically retargeted
              to the robot.</li>
            <li><strong>2. Terrain alignment:</strong> References are used directly on flat terrain and coarsely
              projected onto uneven terrain to provide sparse tracking targets.</li>
            <li><strong>3. Teacher policy learning:</strong> A privileged teacher is trained with RL and learns a Visual
              Goal-in-Context representation that captures the immediate recovery pose and local terrain.</li>
            <li><strong>4. Goal-in-context distillation:</strong> A student distills the teacher’s terrain-aware
              recovery behavior from egocentric depth and short-term proprioceptive history for deployment.</li>
          </ul>
        </div>
      </div>

      <!-- Figure gets the full container width -->
      <div class="columns is-centered">
        <div class="column is-full">
          <figure class="image vigor-figure">
            <img src="./static/images/method.png" alt="Our method diagram">
          </figure>
        </div>
      </div>

    </div>
  </section>

  <!-- FACTORIZED DATA GEN -->
  <section class="section" id="factorized">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full has-text-centered">
          <h2 class="title is-2">Factorized Data Generation</h2>

          <div class="content has-text-justified vigor-prose">
            <p>
              By factorizing motion priors and terrain variation, we enable scalable recovery learning without
              exhaustive pose–terrain coverage.

            </p>
          </div>

          <div class="vigor-wide-video">
            <video class="vigor-video" autoplay controls muted loop playsinline preload="metadata">
              <source src="./static/videos/factorized/factorized_data_gen.mov" type="video/mp4">
            </video>
          </div>

          <div class="vigor-factor-row">
            <div class="vigor-factor-card">
              <div class="vigor-caption-title">Human motions</div>
              <div class="vigor-caption-sub">Sparse demos as structural priors</div>
            </div>

            <div class="vigor-factor-symbol">×</div>

            <div class="vigor-factor-card">
              <div class="vigor-caption-title">Terrain bank</div>
              <div class="vigor-caption-sub">Independent geometry variation</div>
            </div>

            <div class="vigor-factor-symbol">=</div>

            <div class="vigor-factor-card">
              <div class="vigor-caption-title">Projected keypoints</div>
              <div class="vigor-caption-sub">Scalable pose × terrain coverage</div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- FALL -->
  <section class="section" id="fall">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2">Fall Safety</h2>

          <div class="content has-text-justified vigor-prose">
            <p>
              We evaluate our policy on fall mitigation tasks across diverse terrains. We start the robot in a default
              pose, and engage the policy <strong>only after the robot tilts 20 degrees</strong>.
            </p>
          </div>

          <div class="columns is-multiline is-centered">
            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Forward fall</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_forward_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Backward fall</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_backward_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Sideways fall</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_sideways_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Toward stairs</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_towards_stairs_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Diagonal on stairs</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_diag_on_stairs_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Diagonal on stairs</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_diagonal_stairs_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Stones</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_stones_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Off Platform</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/TEST_1768931630_25deg_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Stones</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/fall_mitigation/fall_stones2_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- STAND -->
  <section class="section" id="stand">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2">Stand-Up Recovery</h2>

          <div class="content has-text-justified vigor-prose">
            <p>
              We also evaluate our policy on standing up tasks across many different terrains with diverse initial
              configurations.
            </p>
          </div>

          <div class="columns is-multiline">
            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Flat</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/face_up_ground_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Stones</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/face_down_stones_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Box (face up)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/sitting_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Legs up (face up)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/legs_up.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Stairs (face up)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/stand_up_draped_face_up_over_stair_FLIP_overlay.mp4"
                    type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Stairs (face down)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/face_down_on_stairs_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Gap (face down)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/stand_up_over_gap_face_down_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Gap (face up)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/stand_up_over_gap_face_up_FLIP_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column is-one-third-desktop is-half-tablet is-full-mobile">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Legs up (face down)</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/stand_up/legs_up_face_down_overlay.mp4" type="video/mp4">
                </video>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- SIM -->
  <section class="section" id="exp">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2 has-text-centered">Simulation Experiments</h2>

          <div class="vigor-callout">
            <i class="fas fa-tools"></i>
            <div class="has-text-centered">
              <div class="titleline">Under Construction</div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>


  <!-- LIMITS
  <section class="section" id="limits">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-2">Failure Modes and Limitations</h2>

          <div class="columns is-centered">
            <div class="column">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Backwards Motion</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/failure/backwards_motion.mp4" type="video/mp4">
                </video>
              </div>
            </div>

            <div class="column">
              <div class="content">
                <h3 class="title is-5 vigor-card-title">Mat Interference</h3>
                <video class="vigor-video" autoplay controls muted loop playsinline>
                  <source src="./static/videos/failure/mat_interference.mp4" type="video/mp4">
                </video>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section> -->

  <!-- BIBTEX -->
  <!-- BIBTEX -->
  <section class="section" id="bibtex">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@misc{azulay2026vigor,
  title        = {VIGOR: Visual Goal-In-Context Inference for Unified Humanoid Fall Safety},
  author       = {Osher Azulay and Zhengjie Xu and Andrew Scheffer and Stella X. Yu},
  year         = {2026},
  eprint       = {2602.16511},
  archivePrefix= {arXiv},
  primaryClass = {cs.RO},
  url          = {https://arxiv.org/abs/2602.16511}
}</code></pre>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer" style="padding-top: 2rem; padding-bottom: 2rem;">
    <div class="container is-max-desktop">
      <div class="content has-text-centered vigor-footer-topbar">
        <p class="vigor-footer-title">
          VIGOR: Visual Goal-In-Context Inference for Unified Humanoid Fall Safety
        </p>
        <p class="vigor-footer-muted">
          Page template borrowed from <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>.
        </p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const burgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
      burgers.forEach(el => {
        el.addEventListener('click', () => {
          const target = el.dataset.target;
          const $target = document.getElementById(target);
          el.classList.toggle('is-active');
          $target.classList.toggle('is-active');
        });
      });
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const track = document.getElementById('simTrack');
      if (!track) return;

      const btnL = document.querySelector('#sim .vigor-sim-btn.left');
      const btnR = document.querySelector('#sim .vigor-sim-btn.right');

      const scrollPage = (dir) => {
        track.scrollBy({ left: dir * track.clientWidth, behavior: 'smooth' });
      };

      btnL.addEventListener('click', () => scrollPage(-1));
      btnR.addEventListener('click', () => scrollPage(1));
    });
  </script>

  <script>
    // === Depth overlay sync (viser -> depth video) + NO-FLICKER pause (freeze-frame canvas) ===

    const depthVideo = document.getElementById("depthVid");
    const iframe = document.getElementById("depthFrame");

    if (!depthVideo) console.error("Missing #depthVid");
    if (!iframe) console.error("Missing #depthFrame");

    // ----------------------------
    // Freeze-frame canvas to avoid flicker on pause
    // ----------------------------
    const freezeCanvas = document.createElement("canvas");
    const freezeCtx = freezeCanvas.getContext("2d");

    freezeCanvas.id = "depthFreeze";
    freezeCanvas.style.position = "absolute";
    freezeCanvas.style.inset = "0";
    freezeCanvas.style.width = "100%";
    freezeCanvas.style.height = "100%";
    freezeCanvas.style.display = "none";
    freezeCanvas.style.pointerEvents = "none";

    const overlayParent = depthVideo?.parentElement; // your rounded overlay div
    if (overlayParent) {
      const cs = getComputedStyle(overlayParent);
      if (cs.position === "static") overlayParent.style.position = "relative";
      overlayParent.appendChild(freezeCanvas);
    }

    function showFreezeFrame() {
      if (!depthVideo || !freezeCanvas || !freezeCtx) return;
      if (depthVideo.readyState < 2) return; // need current frame decoded

      const w = depthVideo.videoWidth || 1;
      const h = depthVideo.videoHeight || 1;

      // match intrinsic resolution
      if (freezeCanvas.width !== w) freezeCanvas.width = w;
      if (freezeCanvas.height !== h) freezeCanvas.height = h;

      try {
        freezeCtx.drawImage(depthVideo, 0, 0, w, h);
        freezeCanvas.style.display = "block";
        depthVideo.style.visibility = "hidden";
      } catch (e) {
        // drawImage can fail rarely (CORS / decoder). If so, don't freeze.
        freezeCanvas.style.display = "none";
        depthVideo.style.visibility = "visible";
      }
    }

    function hideFreezeFrame() {
      if (!depthVideo || !freezeCanvas) return;
      freezeCanvas.style.display = "none";
      depthVideo.style.visibility = "visible";
    }

    depthVideo?.addEventListener("pause", () => setTimeout(showFreezeFrame, 30));
    depthVideo?.addEventListener("play", hideFreezeFrame);
    depthVideo?.addEventListener("seeking", () => {
      if (depthVideo.paused) setTimeout(showFreezeFrame, 30);
    });
    depthVideo?.addEventListener("loadedmetadata", hideFreezeFrame);

    // ----------------------------
    // Viser time syncing
    // ----------------------------

    let timeInput = null;
    let lastT = null;
    let lastTChangeMs = performance.now();

    // NEW: keep per-input history so we can pick the one that actually changes.
    const inputState = new WeakMap(); // input -> { lastVal, lastChangeMs, changeCount }

    function findTimeInput(doc) {
      const inputs = Array.from(doc.querySelectorAll("input"));
      const now = performance.now();

      // Update change stats for numeric inputs
      for (const inp of inputs) {
        const v = parseFloat(inp.value);
        if (!Number.isFinite(v)) continue;

        let st = inputState.get(inp);
        if (!st) {
          st = { lastVal: v, lastChangeMs: now, changeCount: 0 };
          inputState.set(inp, st);
          continue;
        }
        if (Math.abs(v - st.lastVal) > 1e-6) {
          st.lastVal = v;
          st.lastChangeMs = now;
          st.changeCount += 1;
        }
      }

      // Pick the input that seems like "time":
      // - has changed at least a few times
      // - and changed recently
      let best = null;
      let bestScore = -Infinity;

      for (const inp of inputs) {
        const st = inputState.get(inp);
        if (!st) continue;

        const ageMs = now - st.lastChangeMs;
        const score = (st.changeCount * 1000) - ageMs; // more changes + more recent wins

        if (score > bestScore) {
          bestScore = score;
          best = inp;
        }
      }

      return best; // may be null on first couple polls
    }

    function tryGetIframeDoc() {
      try {
        return iframe.contentDocument || iframe.contentWindow?.document || null;
      } catch (e) {
        console.error("Can't access iframe DOM (cross-origin). iframe src must be same origin.", e);
        return null;
      }
    }

    function trySync() {
      if (!depthVideo || !iframe) return;

      const doc = tryGetIframeDoc();
      if (!doc) return;

      // re-acquire the correct input if missing / changed
      if (!timeInput || !doc.contains(timeInput)) {
        timeInput = findTimeInput(doc);
        if (!timeInput) return; // warm up
      }

      const t = parseFloat(timeInput.value);
      if (!Number.isFinite(t)) return;

      // Detect whether viser is "paused" by whether t is changing.
      const now = performance.now();
      let viserPaused = false;

      if (lastT === null || Math.abs(t - lastT) > 1e-3) {
        lastT = t;
        lastTChangeMs = now;
        viserPaused = false;
      } else {
        viserPaused = (now - lastTChangeMs > 250);
      }

      // Match pause state: pause overlay when viser pauses; play when viser plays.
      if (viserPaused) {
        if (!depthVideo.paused) depthVideo.pause();
        // Freeze-frame to avoid flicker
        showFreezeFrame();
      } else {
        hideFreezeFrame();
        if (depthVideo.paused) depthVideo.play().catch(() => { });
      }

      // Sync time (deadband to avoid jitter)
      if (Math.abs(depthVideo.currentTime - t) > 0.06) {
        // If paused, update the frame and then refresh freeze snapshot
        depthVideo.currentTime = t;
        if (viserPaused) setTimeout(showFreezeFrame, 30);
      }
    }

    // Reset when iframe reloads (tab switch)
    iframe.addEventListener("load", () => {
      timeInput = null;
      lastT = null;
      lastTChangeMs = performance.now();
      hideFreezeFrame();
    });

    // If source changes, start clean (your tab code calls vid.src + load())
    depthVideo.addEventListener("loadedmetadata", () => {
      hideFreezeFrame();
    });

    setInterval(trySync, 50);
  </script>

  <script>
    // EDIT THESE LISTS ONLY
    const RUNS = {
      teacher: [
        { label: "2front1 steps 1", path: "/recordings/teacher_run/2front1_teacher_steps_1" },
        { label: "2front1 steps 2", path: "/recordings/teacher_run/2front1_teacher_steps_2" },
        { label: "2front1 wave", path: "/recordings/teacher_run/2front1_teacher_wave" },
        { label: "2side3 inv steps", path: "/recordings/teacher_run/2side3_teacher_inv_steps" },
        { label: "7 backright steps", path: "/recordings/teacher_run/7_backright_teacher_steps" },
        { label: "7 left slope", path: "/recordings/teacher_run/7_left_teacher_slope" },
        { label: "7back steps 1", path: "/recordings/teacher_run/7back_teacher_steps_1" },
        { label: "7back steps 2", path: "/recordings/teacher_run/7back_teacher_steps_2" },
        { label: "7back wave", path: "/recordings/teacher_run/7back_teacher_wave" },
        { label: "motion1 wave", path: "/recordings/teacher_run/motion1_teacher_wave" },
      ],

      blind: [
        { label: "2front1 inv steps", path: "/recordings/blind_run/2front1_blind_inv_steps" },
        { label: "2side3 inv steps", path: "/recordings/blind_run/2side3_blind_inv_steps" },
        { label: "7 backright inv steps", path: "/recordings/blind_run/7_backright_blind_inv_steps" },
        { label: "7left slope", path: "/recordings/blind_run/7left_blind_slope" },
        { label: "back steps 1", path: "/recordings/blind_run/back_blind_steps_1" },
        { label: "back steps 2", path: "/recordings/blind_run/back_blind_steps_2" },
        { label: "back steps 3", path: "/recordings/blind_run/back_blind_steps_3" },
        { label: "back wave", path: "/recordings/blind_run/back_blind_wave" },
        { label: "front wave", path: "/recordings/blind_run/front_blind_wave" },
        { label: "motion1 wave", path: "/recordings/blind_run/motion1_blind_wave" },
      ],

      depth: [
        {
          label: "2front1 steps", path: "/recordings/depth_run/2front1_depth_steps",
          depth: "/recordings/depth_run/2front1_depth_steps/depth_pre.mp4"
        },

        {
          label: "2front1 wave", path: "/recordings/depth_run/2front1_depth_wave",
          depth: "/recordings/depth_run/2front1_depth_wave/depth_pre.mp4"
        },

        {
          label: "2side3 inv steps 1", path: "/recordings/depth_run/2side3_depth_inv_steps_1",
          depth: "/recordings/depth_run/2side3_depth_inv_steps_1/depth_pre.mp4"
        },

        {
          label: "2side3 inv steps 2", path: "/recordings/depth_run/2side3_depth_inv_steps_2",
          depth: "/recordings/depth_run/2side3_depth_inv_steps_2/depth_pre.mp4"
        },

        {
          label: "7 backright inv 1", path: "/recordings/depth_run/7backright_depth_inv_steps_1",
          depth: "/recordings/depth_run/7backright_depth_inv_steps_1/depth_pre.mp4"
        },

        {
          label: "7 backright inv 2", path: "/recordings/depth_run/7backright_depth_inv_steps_2",
          depth: "/recordings/depth_run/7backright_depth_inv_steps_2/depth_pre.mp4"
        },

        {
          label: "7left slope", path: "/recordings/depth_run/7left_depth_slope",
          depth: "/recordings/depth_run/7left_depth_slope/depth_pre.mp4"
        },

        {
          label: "back steps 1", path: "/recordings/depth_run/back_depth_steps_1",
          depth: "/recordings/depth_run/back_depth_steps_1/depth_pre.mp4"
        },

        {
          label: "back steps 2", path: "/recordings/depth_run/back_depth_steps_2",
          depth: "/recordings/depth_run/back_depth_steps_2/depth_pre.mp4"
        },

        {
          label: "back steps 3", path: "/recordings/depth_run/back_depth_steps_3",
          depth: "/recordings/depth_run/back_depth_steps_3/depth_pre.mp4"
        },

        {
          label: "back wave", path: "/recordings/depth_run/back_depth_wave",
          depth: "/recordings/depth_run/back_depth_wave/depth_pre.mp4"
        },

        {
          label: "motion1 wave", path: "/recordings/depth_run/motion1_depth_wave",
          depth: "/recordings/depth_run/motion1_depth_wave/depth_pre.mp4"
        },
      ],
    };

    function setFramePlayback(frameId, runBasePath) {
      const frame = document.getElementById(frameId);
      if (!frame) return;
      frame.src = `/viser-client/?playbackPath=${runBasePath}/scene.viser`;
    }

    function setDepthVideo(videoId, videoPath) {
      const vid = document.getElementById(videoId);
      if (!vid) return;
      vid.pause();
      vid.src = videoPath;
      vid.load();
      vid.play().catch(() => { });
    }

    function buildTabs(role, ulId, frameId) {
      const ul = document.getElementById(ulId);
      ul.innerHTML = "";

      const items = RUNS[role] || [];
      items.forEach((item, idx) => {
        const li = document.createElement("li");
        if (idx === 0) li.classList.add("is-active");

        const a = document.createElement("a");
        a.textContent = item.label;
        a.style.whiteSpace = "nowrap";

        a.addEventListener("click", () => {
          Array.from(ul.querySelectorAll("li")).forEach(x => x.classList.remove("is-active"));
          li.classList.add("is-active");

          setFramePlayback(frameId, item.path);
          if (role === "depth" && item.depth) setDepthVideo("depthVid", item.depth);
        });

        li.appendChild(a);
        ul.appendChild(li);
      });

      if (items[0]) {
        setFramePlayback(frameId, items[0].path);
        if (role === "depth" && items[0].depth) setDepthVideo("depthVid", items[0].depth);
      }
    }

    buildTabs("teacher", "teacherTabs", "teacherFrame");
    buildTabs("blind", "blindTabs", "blindFrame");
    buildTabs("depth", "depthTabs", "depthFrame");
  </script>


  <script>
    const heroVid = document.getElementById("heroVid");
    const heroPolicy = document.getElementById("heroPolicy");
    const heroExtra = document.getElementById("heroExtra");

    const ENABLE_TIME = 3.7;
    const PROTECT_TIME = 4.0;
    const PROTECT_DURATION = 5.0;

    function updateHeroOverlay() {
      if (!heroVid || !heroPolicy || !heroExtra) return;
      const t = heroVid.currentTime || 0;

      heroPolicy.classList.remove("state-disabled", "state-enabled");

      if (t >= ENABLE_TIME) {
        heroPolicy.textContent = "Policy enabled";
        heroPolicy.classList.add("state-enabled");
      } else {
        heroPolicy.textContent = "Policy disabled";
        heroPolicy.classList.add("state-disabled");
      }

      if (t >= PROTECT_TIME && t < PROTECT_TIME + PROTECT_DURATION) {
        heroExtra.textContent = "Terrain aware recovery!";
      } else {
        heroExtra.textContent = "";
      }
    }

    ["timeupdate", "seeking", "seeked", "play", "loadedmetadata"].forEach(ev => {
      heroVid?.addEventListener(ev, updateHeroOverlay);
    });

    updateHeroOverlay();
  </script>

</body>

</html>